#
#修改以下代码或者开启触发开关都好，要严格按格式对好,前面有多少空格也要看清楚
#
# This is a basic workflow to help you get started with Actions

name: bl-mt798x-r30b1 uboot

on: 

  repository_dispatch:
  workflow_dispatch:

env:
  REPO_URL: https://github.com/benboguan/bl-mt798x
  REPO_BRANCH: master
  UPLOAD_BIN_DIR: true
  UPLOAD_FIRMWARE: true
  UPLOAD_COWTRANSFER: flase
  UPLOAD_WETRANSFER: true
  UPLOAD_RELEASE: true

jobs:
  build:
    name: 编译bl-mt798x uboot
    runs-on: ubuntu-22.04

    steps:
    - name: 准备结束
      uses: actions/checkout@main

    - name: 开始安装编译所需系统
      env:
        DEBIAN_FRONTEND: noninteractive
      run: |
        sudo -E apt-get update
        sudo -E apt-get -y install build-essential gcc-aarch64-linux-gnu build-essential flex bison libssl-dev python3-distutils device-tree-compiler
        sudo -E apt-get -y autoremove
        sudo -E apt-get autoclean
    - name: 下载uboot源码
      run: |
        git clone https://github.com/benboguan/bl-mt798x.git /opt/uboot
    - name: 编译uboot
      run: |
        cd /opt/uboot
        sudo chmod +x build.sh
        sudo ./build.sh
    - name : 上传
      uses: actions/upload-artifact@v3
      with:
        name: u-boot
        path: "uboot-mt7981/archive/"